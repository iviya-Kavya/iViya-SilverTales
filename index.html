<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>iViya ‚Äî Silver Tales</title>
<style>
  :root{
    --bg:#0f1724;        /* dark panel bg */
    --panel:#0b1220;
    --muted:#9aa4b2;
    --accent:#d1d5db;
    --card-bg:#fff;
    --brand:#222;
    --glass: rgba(255,255,255,0.06);
  }
  html { scroll-behavior: smooth; }
  body { margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; background:#f6f7fb; color:#111; }

  /* NAV */
  nav{
    position:sticky; top:0; z-index:1200;
    display:flex; align-items:center; justify-content:space-between;
    padding:10px 14px; gap:12px;
    backdrop-filter: blur(10px);
    background: rgba(255,255,255,0.75);
    box-shadow:0 2px 8px rgba(0,0,0,.06);
  }
  .menu-icon{ display:flex; flex-direction:column; gap:4px; width:26px; cursor:pointer; }
  .menu-icon div{ height:3px; background:#333; border-radius:3px; transition:all .25s ease; }
  .menu-icon.active div:nth-child(1){ transform:rotate(45deg) translateY(6px); }
  .menu-icon.active div:nth-child(2){ opacity:0; transform:scaleX(.2); }
  .menu-icon.active div:nth-child(3){ transform:rotate(-45deg) translateY(-6px); }

  .logo { text-align:center; line-height:1; }
  .logo .title { font-weight:700; font-size:18px; color:var(--brand); }
  .logo .tag { display:block; font-size:11px; color:#666; margin-top:2px; letter-spacing:0.6px; }

  .icons { display:flex; gap:12px; align-items:center; font-size:18px; }
  .icon-btn { position:relative; cursor:pointer; text-decoration:none; color:inherit; background:none; border:none; font-size:18px; }
  .badge { position:absolute; top:-6px; right:-10px; background:#ef4444; color:#fff; font-size:11px; padding:2px 6px; border-radius:999px; }

  /* top menu (desktop) */
  .menu {
  position: fixed;           /* was absolute ‚Äî now fixed to viewport */
  top: 60px;                 /* just below the navbar */
  left: 0;
  width: 100%;
  background: rgba(255,255,255,0.95);
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  display: none;
  flex-direction: column;
  text-align: center;
  z-index: 2000;             /* ensures it‚Äôs always above all sections */
  }
  .menu a { text-decoration:none; color:#444; padding:6px 10px; border-radius:6px; font-weight:500; }
  @media(min-width:768px){
    .menu { display:flex; position:static; width:auto; background:transparent; box-shadow:none; }
    .menu-icon{ display:none; }
  }

  /* dropdown mobile menu */
  .menu-panel{
    position:absolute; left:0; right:0; top:60px; display:none; flex-direction:column; background:rgba(255,255,255,0.98);
    box-shadow:0 8px 30px rgba(2,6,23,0.12); z-index:1100;
  }
  .menu-panel a{ padding:14px; border-bottom:1px solid #eef2f6; color:#222; text-decoration:none; font-weight:600; }

  /* page sections */
  section { padding:56px 18px; text-align:center; scroll-margin-top:90px; }
  h1 { margin:0 0 12px; font-size:24px; color:#222; }
  p.lead { color:#555; max-width:760px; margin:8px auto 0; line-height:1.6; }

  /* collections grid */
  .grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); gap:16px; padding:18px; max-width:1200px; margin:20px auto; }
  .card { background:var(--card-bg); border-radius:12px; overflow:hidden; box-shadow:0 6px 18px rgba(12,20,30,0.06); position:relative; display:flex; flex-direction:column; }
  .card .imgwrap{ width:100%; height:260px; background:#fff; display:flex; align-items:center; justify-content:center; overflow:hidden; }
  .card img{ width:100%; height:100%; object-fit:contain; display:block; }
  .card .info { padding:12px 14px 16px; flex:1; display:flex; flex-direction:column; gap:8px; }
  .name{ font-weight:700; font-size:15px; color:#111; }
  .price{ font-weight:700; color:#111; }
  .desc{ color:var(--muted); font-size:13px; flex:1; }

  /* wishlist heart on card */
  .heart-btn{
    position:absolute; top:12px; right:12px; z-index:4; width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; background:rgba(255,255,255,0.9); box-shadow:0 6px 14px rgba(10,12,20,.06);
    cursor:pointer; border:none;
  }
  .heart-btn.active{ background:#ffeef0; color:#ef4444; }

  .add-cart { margin-top:8px; border:none; background:#111; color:#fff; padding:8px 10px; border-radius:8px; cursor:pointer; font-weight:600; }

  /* panels (dark) */
  .panel-overlay { position:fixed; inset:0; display:none; z-index:1300; }
  .side-panel {
    position:fixed; top:0; right:0; height:100vh; width:380px; max-width:94vw;
    transform:translateX(110%); transition:transform .28s cubic-bezier(.2,.9,.25,1);
    background:var(--panel); color:var(--accent); z-index:1400; box-shadow:-20px 0 60px rgba(2,6,23,.6);
    display:flex; flex-direction:column;
  }
  .side-panel.open{ transform:translateX(0); }
  .panel-head { padding:18px; display:flex; align-items:center; justify-content:space-between; border-bottom:1px solid rgba(255,255,255,0.04); }
  .panel-head h3{ margin:0; font-size:18px; color:#fff; }
  .panel-body{ padding:12px; overflow:auto; flex:1; }
  .panel-item{ display:flex; gap:10px; align-items:center; padding:10px 0; border-bottom:1px solid rgba(255,255,255,0.03); }
  .panel-item img{ width:64px; height:64px; object-fit:contain; border-radius:8px; background:#fff; padding:6px; }
  .panel-item .meta{ flex:1; }
  .panel-item .meta .pn{ font-weight:600; color:#fff; }
  .panel-item .meta .pm{ color:var(--muted); font-size:13px; margin-top:6px; }

  .qty-controls{ display:flex; gap:8px; align-items:center; margin-top:6px; }
  .qty-controls button{ width:30px; height:30px; border-radius:6px; border:none; background:#111; color:#fff; cursor:pointer; }
  .remove-btn{ background:transparent; color:#ef9a9a; border:none; cursor:pointer; font-weight:600; }

  .panel-footer{ padding:12px; border-top:1px solid rgba(255,255,255,0.03); display:flex; gap:8px; align-items:center; justify-content:space-between; }
  .total { font-weight:700; color:#fff; }
  .checkout-btn{ background:#ef4444; color:#fff; border:none; padding:10px 14px; border-radius:8px; cursor:pointer; font-weight:700; }

  /* small screens adjustments */
  @media(max-width:420px){
    .side-panel{ width:100%; max-width:100vw; }
    .menu-panel a{ padding:12px; }
    .card .imgwrap{ height:200px; }
  }
</style>
</head>
<body>
  <!-- NAV -->
  <nav>
    <div class="menu-icon" id="menuToggle" aria-label="Toggle menu" title="Menu">
      <div></div><div></div><div></div>
    </div>

    <div class="logo" aria-hidden="true">
      <div class="title">iViya</div>
      <div class="tag">Silver Tales</div>
    </div>

    <div style="display:flex;align-items:center;gap:12px">
      <div class="menu" id="desktopMenu">
        <a href="#home">Home</a>
        <a href="#about">About</a>
        <a href="#collections">Collections</a>
        <a href="#login">Login</a>
        <a href="#signup">Sign Up</a>
        <a href="https://wa.me/919876543210" target="_blank">WhatsApp</a>
        <a href="#contact">Contact</a>
      </div>

      <div class="icons">
        <button class="icon-btn" id="wishToggle" title="Wishlist">‚ù§Ô∏è <span id="wishCount" class="badge" style="display:none">0</span></button>
        <button class="icon-btn" id="cartToggle" title="Cart">üõçÔ∏è <span id="cartCount" class="badge" style="display:none">0</span></button>
      </div>
    </div>
  </nav>

  <!-- mobile menu panel -->
  <div class="menu-panel" id="menuPanel" role="menu" aria-hidden="true">
    <a href="#home">Home</a>
    <a href="#about">About</a>
    <a href="#collections">Collections</a>
    <a href="#login">Login</a>
    <a href="#signup">Sign Up</a>
    <a href="https://wa.me/919876543210" target="_blank">WhatsApp</a>
    <a href="#contact">Contact</a>
  </div>

  <!-- sections -->
  <section id="home">
    <h1>Welcome to iViya ‚Äî Silver Tales</h1>
    <p class="lead">Discover handcrafted silver jewellery that tells your story. Update products in your Google Sheet and this page will reflect them automatically.</p>
  </section>

  <section id="about">
    <h2>About</h2>
    <p class="lead">At iViya we combine handcrafted techniques with modern minimalism to create pieces that last a lifetime.</p>
  </section>

  <section id="collections">
    <h2>Collections</h2>
    <div id="grid" class="grid" aria-live="polite"></div>
  </section>

  <section id="contact">
    <h2>Contact</h2>
    <p class="lead">Email: <strong>contact@iviyasilver.com</strong> ‚Ä¢ WhatsApp: <a href="https://wa.me/919876543210" target="_blank">Chat</a></p>
  </section>

  <section id="login"><h2>Login</h2></section>
  <section id="signup"><h2>Sign Up</h2></section>

  <!-- overlay for panels -->
  <div class="panel-overlay" id="panelOverlay" style="display:none;"></div>

  <!-- WISHLIST PANEL (dark) -->
  <aside class="side-panel" id="wishPanel" aria-hidden="true">
    <div class="panel-head">
      <h3>Wishlist</h3>
      <button class="icon-btn" id="closeWish" style="color:var(--accent)">‚úï</button>
    </div>
    <div class="panel-body" id="wishBody">
      <p style="color:var(--muted);">Your wishlist is empty.</p>
    </div>
    <div class="panel-footer" style="display:none" id="wishFooter">
      <div style="color:var(--muted)">Items</div>
      <div><button class="checkout-btn" id="wishCheckout">View / Proceed</button></div>
    </div>
  </aside>

  <!-- CART PANEL (dark) -->
  <aside class="side-panel" id="cartPanel" aria-hidden="true">
    <div class="panel-head">
      <h3>Cart</h3>
      <button class="icon-btn" id="closeCart" style="color:var(--accent)">‚úï</button>
    </div>
    <div class="panel-body" id="cartBody">
      <p style="color:var(--muted)">Your cart is empty.</p>
    </div>
    <div class="panel-footer" id="cartFooter" style="display:none">
      <div class="total" id="cartTotal">‚Çπ0</div>
      <div><button class="checkout-btn" id="checkoutBtn">Checkout</button></div>
    </div>
  </aside>

<script>
/* -------------------------
   Config
------------------------- */
const SHEET_URL = 'https://opensheet.elk.sh/1-ZrGnfPbTtmStHS8kWvQUHt7pnVMUjEb8TK7iloYoBs/Sheet1';
const LS_WISH = 'iv_wishlist';
const LS_CART = 'iv_cart';

/* -------------------------
   Utilities
------------------------- */
function fmtINR(n){
  const num = Number(n) || 0;
  return new Intl.NumberFormat('en-IN', { style:'currency', currency:'INR', maximumFractionDigits:0 }).format(num);
}
function uidFor(p){ return (p.sku || p.id || p.name || JSON.stringify(p)).toString(); }

/* -------------------------
   Local Storage helpers
------------------------- */
function loadWishlist(){ try { return JSON.parse(localStorage.getItem(LS_WISH) || '[]'); } catch(e){ return []; } }
function saveWishlist(list){ localStorage.setItem(LS_WISH, JSON.stringify(list)); updateWishBadge(); }
function loadCart(){ try { return JSON.parse(localStorage.getItem(LS_CART) || '{}'); } catch(e){ return {}; } }
function saveCart(obj){ localStorage.setItem(LS_CART, JSON.stringify(obj)); updateCartBadge(); }

/* -------------------------
   UI: badges & panels
------------------------- */
const wishToggle = document.getElementById('wishToggle');
const cartToggle = document.getElementById('cartToggle');
const wishCountEl = document.getElementById('wishCount');
const cartCountEl = document.getElementById('cartCount');
const wishPanel = document.getElementById('wishPanel');
const cartPanel = document.getElementById('cartPanel');
const panelOverlay = document.getElementById('panelOverlay');

function updateWishBadge(){
  const list = loadWishlist();
  if(list.length) { wishCountEl.style.display='inline-block'; wishCountEl.textContent = list.length; }
  else { wishCountEl.style.display='none'; }
}
function updateCartBadge(){
  const cart = loadCart();
  const totalQty = Object.values(cart).reduce((s,it)=> s + (it.qty||0), 0);
  if(totalQty) { cartCountEl.style.display='inline-block'; cartCountEl.textContent = totalQty; }
  else { cartCountEl.style.display='none'; }
}
function openPanel(panel){
  panelOverlay.style.display='block';
  panel.classList.add('open');
  panel.setAttribute('aria-hidden','false');
}
function closePanels(){
  panelOverlay.style.display='none';
  wishPanel.classList.remove('open');
  cartPanel.classList.remove('open');
  wishPanel.setAttribute('aria-hidden','true');
  cartPanel.setAttribute('aria-hidden','true');
}

/* close when overlay clicked */
panelOverlay.addEventListener('click', closePanels);
document.getElementById('closeWish').addEventListener('click', closePanels);
document.getElementById('closeCart').addEventListener('click', closePanels);

/* toggle via top icons */
wishToggle.addEventListener('click', () => {
  if(wishPanel.classList.contains('open')) closePanels();
  else { populateWishPanel(); openPanel(wishPanel); }
});
cartToggle.addEventListener('click', () => {
  if(cartPanel.classList.contains('open')) closePanels();
  else { populateCartPanel(); openPanel(cartPanel); }
});

/* menu toggle mobile */
const menuToggle = document.getElementById('menuToggle');
const menuPanel = document.getElementById('menuPanel');
menuToggle.addEventListener('click', ()=>{
  menuToggle.classList.toggle('active');
  if(menuPanel.style.display === 'flex'){ menuPanel.style.display = 'none'; } else { menuPanel.style.display = 'flex'; menuPanel.style.flexDirection='column'; }
});

/* -------------------------
   Product rendering
------------------------- */
const grid = document.getElementById('grid');

fetch(SHEET_URL)
  .then(r=>r.json())
  .then(data=>{
    // data is array of objects
    data.forEach(p=>{
      const id = uidFor(p);
      const img = p.image_url || p.image || 'https://via.placeholder.com/400x300?text=No+Image';
      const name = p.name || p.title || 'Untitled';
      const price = Number(p.price) || 0;
      const desc = p.description || p.desc || '';

      // card
      const el = document.createElement('div'); el.className='card';
      el.innerHTML = `
        <button class="heart-btn" data-id="${id}" title="Add to wishlist">‚ô°</button>
        <div class="imgwrap"><img src="${img}" alt="${name}" loading="lazy"></div>
        <div class="info">
          <div class="name">${name}</div>
          <div class="price">${fmtINR(price)}</div>
          <div class="desc">${desc}</div>
          <div style="display:flex;gap:8px;align-items:center;margin-top:8px">
            <button class="add-cart" data-id="${id}">Add to cart</button>
          </div>
        </div>
      `;
      // save item data on element for quick lookup
      el.dataset.item = JSON.stringify({ id, name, price, img });
      grid.appendChild(el);

      // heart behavior
      const heart = el.querySelector('.heart-btn');
      function refreshHeart(){
        const wish = loadWishlist();
        const exists = wish.find(x=>x.id === id);
        heart.classList.toggle('active', !!exists);
        heart.textContent = exists ? '‚ù§Ô∏è' : '‚ô°';
      }
      refreshHeart();
      heart.addEventListener('click', (ev) => {
        ev.stopPropagation();
        let list = loadWishlist();
        const exists = list.find(x=> x.id === id);
        if(exists){ list = list.filter(x=> x.id !== id); }
        else {
          const item = JSON.parse(el.dataset.item);
          list.push({ id:item.id, name:item.name, price:item.price, img:item.img });
        }
        saveWishlist(list);
        refreshHeart();
      });

      // add to cart behavior
      const addBtn = el.querySelector('.add-cart');
      addBtn.addEventListener('click', (ev)=>{
        ev.stopPropagation();
        const item = JSON.parse(el.dataset.item);
        const cart = loadCart();
        if(!cart[item.id]) cart[item.id] = { id:item.id, name:item.name, price:item.price, img:item.img, qty:0 };
        cart[item.id].qty = (cart[item.id].qty || 0) + 1;
        saveCart(cart);
      });

      // click image to zoom
      el.querySelector('.imgwrap img').addEventListener('click', (e)=>{
        e.stopPropagation();
        showZoom(img);
      });
    });

    // initial badges
    updateWishBadge();
    updateCartBadge();
  })
  .catch(err=>{
    console.error('Failed to load sheet', err);
    grid.innerHTML = '<p style="grid-column:1/-1;color:#777">Failed to load products.</p>';
  });

/* -------------------------
   Panels population
------------------------- */
function populateWishPanel(){
  const container = document.getElementById('wishBody');
  const list = loadWishlist();
  container.innerHTML = '';
  if(!list.length){
    container.innerHTML = '<p style="color:var(--muted)">Your wishlist is empty.</p>';
    document.getElementById('wishFooter').style.display='none';
    return;
  }
  document.getElementById('wishFooter').style.display='flex';
  list.forEach(item=>{
    const row = document.createElement('div'); row.className='panel-item';
    row.innerHTML = `
      <img src="${item.img}" alt="${item.name}">
      <div class="meta">
        <div class="pn">${item.name}</div>
        <div class="pm">${fmtINR(item.price)}</div>
        <div style="margin-top:8px">
          <button class="remove-btn" data-id="${item.id}">Remove</button>
        </div>
      </div>
    `;
    container.appendChild(row);
  });
  // remove handlers
  container.querySelectorAll('.remove-btn').forEach(btn=>{
    btn.addEventListener('click', () => {
      const id = btn.dataset.id;
      let list = loadWishlist();
      list = list.filter(x=> x.id !== id);
      saveWishlist(list);
      populateWishPanel();
    });
  });
}

function populateCartPanel(){
  const container = document.getElementById('cartBody');
  const cart = loadCart();
  container.innerHTML = '';
  const ids = Object.keys(cart);
  if(!ids.length){
    container.innerHTML = '<p style="color:var(--muted)">Your cart is empty.</p>';
    document.getElementById('cartFooter').style.display='none';
    return;
  }
  document.getElementById('cartFooter').style.display='flex';
  let total = 0;
  ids.forEach(id=>{
    const it = cart[id];
    total += (it.price || 0) * (it.qty || 0);
    const row = document.createElement('div'); row.className='panel-item';
    row.innerHTML = `
      <img src="${it.img}" alt="${it.name}">
      <div class="meta">
        <div class="pn">${it.name}</div>
        <div class="pm">${fmtINR(it.price)} ‚Ä¢ Qty: <strong id="q-${id}">${it.qty}</strong></div>
        <div class="qty-controls" style="margin-top:8px">
          <button class="dec" data-id="${id}">‚àí</button>
          <button class="inc" data-id="${id}">+</button>
          <button class="remove-btn" data-id="${id}" style="margin-left:12px">Remove</button>
        </div>
      </div>
    `;
    container.appendChild(row);
  });

  document.getElementById('cartTotal').textContent = fmtINR(total);

  // attach handlers
  container.querySelectorAll('.inc').forEach(b=>{
    b.addEventListener('click', ()=>{
      const id = b.dataset.id;
      const cartObj = loadCart();
      cartObj[id].qty = (cartObj[id].qty || 0) + 1;
      saveCart(cartObj);
      populateCartPanel();
    });
  });
  container.querySelectorAll('.dec').forEach(b=>{
    b.addEventListener('click', ()=>{
      const id = b.dataset.id;
      const cartObj = loadCart();
      cartObj[id].qty = Math.max(0, (cartObj[id].qty || 0) - 1);
      if(cartObj[id].qty === 0) delete cartObj[id];
      saveCart(cartObj);
      populateCartPanel();
    });
  });
  container.querySelectorAll('.remove-btn').forEach(b=>{
    b.addEventListener('click', ()=>{
      const id = b.dataset.id;
      const cartObj = loadCart();
      delete cartObj[id];
      saveCart(cartObj);
      populateCartPanel();
    });
  });
}

/* checkout action - simple placeholder */
document.getElementById('checkoutBtn').addEventListener('click', ()=>{
  const cart = loadCart();
  if(Object.keys(cart).length === 0) return alert('Cart is empty');
  // example: show JSON or redirect to checkout
  alert('Checkout placeholder ‚Äî implement your checkout flow. Cart total: ' + document.getElementById('cartTotal').textContent);
});

/* wishlist proceed (placeholder) */
document.getElementById('wishCheckout').addEventListener('click', ()=>{
  const list = loadWishlist();
  if(list.length === 0) return alert('Wishlist empty');
  alert('Wishlist has ' + list.length + ' items. Implement a flow to move items to cart or contact.');
});

/* keep badges up-to-date */
updateWishBadge();
updateCartBadge();

/* -------------------------
   Image zoom (reuse simple zoom)
------------------------- */
const zoomModal = document.createElement('div');
zoomModal.style.position='fixed';
zoomModal.style.inset='0';
zoomModal.style.display='none';
zoomModal.style.justifyContent='center';
zoomModal.style.alignItems='center';
zoomModal.style.background='rgba(0,0,0,0.85)';
zoomModal.style.zIndex=1600;
zoomModal.addEventListener('click', ()=> { zoomModal.style.display='none'; });
const zoomImg = document.createElement('img');
zoomImg.style.maxWidth='95vw';
zoomImg.style.maxHeight='95vh';
zoomImg.style.borderRadius='8px';
zoomImg.style.boxShadow='0 20px 60px rgba(0,0,0,0.6)';
zoomModal.appendChild(zoomImg);
document.body.appendChild(zoomModal);
function showZoom(src){ zoomImg.src = src; zoomModal.style.display='flex'; }

/* accessibility: close panels with ESC */
document.addEventListener('keydown', (e)=> {
  if(e.key === 'Escape'){
    closePanels();
    zoomModal.style.display='none';
    menuPanel.style.display='none';
    menuToggle.classList.remove('active');
  }
});

/* ensure panels close when navigating anchors */
document.querySelectorAll('.menu-panel a, .menu a').forEach(a=>{
  a.addEventListener('click', ()=> { menuPanel.style.display='none'; menuToggle.classList.remove('active'); closePanels(); });
});
</script>
</body>
</html>
